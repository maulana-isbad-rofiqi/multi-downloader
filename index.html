<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kaltain MultiLoader ‚Ä¢ Professional Tool</title>
    <meta name="theme-color" content="#020617">
    <meta name="description" content="Premium Media Downloader for TikTok, YouTube, Spotify & More.">
    
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/7269/7269995.png" type="image/png">
    <link rel="manifest" href="manifest.json">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
                    colors: {
                        brand: { 500: '#3b82f6', 600: '#2563eb', glow: '#60a5fa' },
                        dark: { 900: '#020617', 800: '#0f172a', 700: '#1e293b' }
                    },
                    animation: {
                        'blob': 'blob 7s infinite',
                        'fade-up': 'fadeUp 0.5s ease-out forwards'
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' }
                        },
                        fadeUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Modern Enhancements */
        body { background-color: #020617; color: white; -webkit-tap-highlight-color: transparent; }
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .input-glow:focus-within {
            box-shadow: 0 0 20px -5px rgba(59, 130, 246, 0.5);
            border-color: rgba(96, 165, 250, 0.5);
        }
        /* Hide Scrollbar but keep functionality */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Skeleton Animation */
        .skeleton {
            background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
</head>
<body class="min-h-screen flex flex-col relative overflow-x-hidden">

    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-0 left-1/4 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-[128px] opacity-20 animate-blob"></div>
        <div class="absolute top-0 right-1/4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-[128px] opacity-20 animate-blob animation-delay-2000"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-white/5">
        <div class="max-w-4xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-gradient-to-tr from-blue-600 to-cyan-500 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/20">
                    <i class="fa-solid fa-cloud text-white text-sm"></i>
                </div>
                <span class="font-bold text-lg tracking-tight">Kaltain<span class="text-blue-400">Loader</span></span>
            </div>
            <button onclick="toggleModal('aboutModal')" class="w-8 h-8 rounded-full bg-white/5 hover:bg-white/10 flex items-center justify-center transition">
                <i class="fa-solid fa-info text-xs text-slate-400"></i>
            </button>
        </div>
    </nav>

    <main class="relative z-10 flex-grow container mx-auto px-4 mt-32 max-w-2xl pb-20">
        
        <div class="text-center mb-10 animate-fade-up">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-500/10 border border-blue-500/20 mb-4">
                <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                <span class="text-[10px] font-semibold text-blue-400 uppercase tracking-wider">Online System v3.0</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-b from-white to-slate-400">
                Download Tanpa Batas.
            </h1>
            <p class="text-slate-400 text-sm md:text-base max-w-md mx-auto">
                Mendukung TikTok, YouTube, Spotify, Instagram, dan 10+ platform lainnya. Tempel link, kami proses otomatis.
            </p>
        </div>

        <div class="glass-panel p-2 rounded-2xl mb-8 transition-all duration-300 input-glow animate-fade-up" style="animation-delay: 100ms;">
            <div class="relative flex items-center">
                <div class="absolute left-4 text-slate-500" id="inputIconWrapper">
                    <i class="fa-solid fa-link transition-all" id="inputIcon"></i>
                </div>
                <input type="text" id="urlInput" 
                    class="w-full bg-transparent border-none text-white text-sm px-12 py-4 focus:ring-0 placeholder-slate-500"
                    placeholder="Tempel tautan atau ketik judul lagu..."
                    autocomplete="off"
                    oninput="handleInput(this.value)">
                
                <button onclick="executeDownload()" id="mainBtn"
                    class="absolute right-2 bg-blue-600 hover:bg-blue-500 text-white p-3 rounded-xl transition shadow-lg shadow-blue-600/20 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <div id="detectBadge" class="hidden mx-auto w-max mb-8 px-4 py-1.5 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-xs font-medium flex items-center gap-2 animate-fade-up">
            <i class="fa-solid fa-check-circle"></i>
            <span id="detectText">Platform Terdeteksi</span>
        </div>

        <div id="platformGrid" class="grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-4 mb-12 animate-fade-up" style="animation-delay: 200ms;">
            </div>

        <div id="resultCard" class="hidden glass-panel rounded-3xl overflow-hidden shadow-2xl animate-fade-up border-t border-white/10">
            <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-white/5">
                <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Hasil Proses</span>
                <button onclick="closeResult()" class="text-slate-500 hover:text-white"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-6">
                <div class="flex flex-col md:flex-row gap-6 items-start">
                    <div class="relative w-full md:w-40 shrink-0 rounded-xl overflow-hidden shadow-lg group">
                        <img id="resThumb" src="" class="w-full aspect-video md:aspect-square object-cover bg-slate-800" alt="Thumb">
                        <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
                            <i class="fa-solid fa-play text-white text-2xl"></i>
                        </div>
                    </div>
                    <div class="w-full">
                        <h3 id="resTitle" class="font-bold text-lg leading-snug mb-2 text-white line-clamp-2">Title Here</h3>
                        <p id="resSource" class="text-xs text-blue-400 mb-4 font-mono">Source: Unknown</p>
                        
                        <div id="downloadList" class="space-y-2.5 max-h-60 overflow-y-auto no-scrollbar pr-1">
                            </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="loader" class="hidden animate-fade-up">
            <div class="glass-panel p-6 rounded-3xl">
                <div class="flex gap-4">
                    <div class="w-24 h-24 rounded-xl skeleton shrink-0"></div>
                    <div class="w-full space-y-3 py-2">
                        <div class="w-3/4 h-6 rounded skeleton"></div>
                        <div class="w-1/2 h-4 rounded skeleton"></div>
                        <div class="w-full h-10 rounded-lg skeleton mt-2"></div>
                    </div>
                </div>
            </div>
            <p class="text-center text-xs text-slate-500 mt-4 animate-pulse">Menghubungkan ke server premium...</p>
        </div>

    </main>

    <div id="toast" class="fixed top-24 right-4 z-[100] transform translate-x-[150%] transition-transform duration-300 flex items-center gap-3 px-4 py-3 bg-slate-800 border-l-4 border-blue-500 rounded shadow-2xl max-w-xs">
        <i id="toastIcon" class="fa-solid fa-info-circle text-blue-500"></i>
        <div>
            <h4 id="toastTitle" class="font-bold text-sm text-white">Info</h4>
            <p id="toastMsg" class="text-xs text-slate-400">Message here</p>
        </div>
    </div>

    <div id="aboutModal" class="fixed inset-0 z-[100] hidden bg-black/90 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="glass-panel bg-slate-900 p-8 rounded-3xl max-w-sm w-full text-center relative border border-slate-700">
            <button onclick="toggleModal('aboutModal')" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fa-solid fa-xmark"></i></button>
            <div class="w-16 h-16 bg-blue-600 rounded-2xl mx-auto mb-4 flex items-center justify-center text-2xl text-white font-bold shadow-lg shadow-blue-600/30">IB</div>
            <h3 class="text-xl font-bold text-white">Kaltain MultiLoader</h3>
            <p class="text-xs text-slate-500 mb-6 mt-1">Version 3.0.1 (Stable)</p>
            <div class="border-t border-slate-700 pt-4">
                <p class="text-xs text-slate-400">Created with <i class="fa-solid fa-heart text-red-500 mx-1"></i> by</p>
                <p class="text-lg font-bold text-blue-400 mt-1">„ÄêÔªø ùïÄùï•ùï§ùïìùïíùïï „Äë</p>
            </div>
        </div>
    </div>

    <script>
        // --- DATA API & CONFIG ---
        const apiBase = "https://api.ootaizumi.web.id/downloader/";
        const platforms = {
            tiktok: { name: "TikTok", icon: "fa-brands fa-tiktok", color: "text-pink-500", match: ["tiktok.com"], apis: [{end:"tiktok",p:"url"},{end:"ssstiktok",p:"url"},{end:"snaptik",p:"url"}] },
            youtube: { name: "YouTube", icon: "fa-brands fa-youtube", color: "text-red-500", match: ["youtube.com","youtu.be"], apis: [{end:"youtube",p:"url",x:"&format=mp4"},{end:"youtubev2",p:"url"},{end:"youtube-play",p:"query"}] },
            spotify: { name: "Spotify", icon: "fa-brands fa-spotify", color: "text-green-500", match: ["spotify.com"], apis: [{end:"spotify-v2",p:"url"},{end:"spotify",p:"url"}] },
            instagram: { name: "Instagram", icon: "fa-brands fa-instagram", color: "text-purple-500", match: ["instagram.com"], apis: [{end:"instagram",p:"url"}] },
            facebook: { name: "Facebook", icon: "fa-brands fa-facebook", color: "text-blue-600", match: ["facebook.com","fb.watch"], apis: [{end:"facebook",p:"url"}] },
            twitter: { name: "Twitter", icon: "fa-brands fa-x-twitter", color: "text-white", match: ["twitter.com","x.com"], apis: [{end:"twitter",p:"url"}] },
            pinterest: { name: "Pinterest", icon: "fa-brands fa-pinterest", color: "text-red-600", match: ["pinterest.com","pin.it"], apis: [{end:"pinterest",p:"url"}] },
            soundcloud: { name: "SoundCloud", icon: "fa-brands fa-soundcloud", color: "text-orange-500", match: ["soundcloud.com"], apis: [{end:"soundcloud",p:"url"}] },
            gdrive: { name: "Drive", icon: "fa-brands fa-google-drive", color: "text-green-400", match: ["drive.google.com"], apis: [{end:"gdrive",p:"url"}] },
            mediafire: { name: "Mediafire", icon: "fa-solid fa-fire", color: "text-blue-400", match: ["mediafire.com"], apis: [{end:"mediafire",p:"url"}] },
            // Manual Only
            ytsearch: { name: "Cari Lagu", icon: "fa-solid fa-magnifying-glass", color: "text-yellow-400", isSearch: true, apis: [{end:"youtube-play",p:"query"}] }
        };

        let currentMode = 'auto';

        // --- INIT UI ---
        window.onload = () => {
            const grid = document.getElementById('platformGrid');
            Object.keys(platforms).forEach(k => {
                const p = platforms[k];
                // Show only 8 main items on grid to keep it clean, others via auto-detect
                if(k === 'ytsearch' || Object.keys(platforms).indexOf(k) < 11) {
                    const btn = document.createElement('button');
                    btn.className = "flex flex-col items-center gap-2 group p-2 rounded-xl hover:bg-white/5 transition";
                    btn.onclick = () => setManual(k);
                    btn.innerHTML = `
                        <div class="w-10 h-10 rounded-full bg-slate-800 border border-slate-700 flex items-center justify-center group-hover:border-${p.color.split('-')[1]}-500/50 transition">
                            <i class="${p.icon} ${p.color} text-lg"></i>
                        </div>
                        <span class="text-[10px] text-slate-400 group-hover:text-white">${p.name}</span>
                    `;
                    grid.appendChild(btn);
                }
            });
            // Register SW
            if('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
        };

        // --- LOGIC ---
        function handleInput(val) {
            const icon = document.getElementById('inputIcon');
            const badge = document.getElementById('detectBadge');
            
            if(!val) {
                resetMode();
                return;
            }

            let found = false;
            for(const [k, d] of Object.entries(platforms)) {
                if(d.match && d.match.some(domain => val.includes(domain))) {
                    currentMode = k;
                    icon.className = `${d.icon} ${d.color}`;
                    document.getElementById('detectText').innerText = d.name;
                    badge.classList.remove('hidden');
                    found = true;
                    break;
                }
            }
            if(!found && currentMode === 'auto') {
                icon.className = "fa-solid fa-link text-slate-500";
                badge.classList.add('hidden');
            }
        }

        function setManual(key) {
            currentMode = key;
            const p = platforms[key];
            const input = document.getElementById('urlInput');
            document.getElementById('detectText').innerText = "Mode: " + p.name;
            document.getElementById('detectBadge').classList.remove('hidden');
            document.getElementById('inputIcon').className = `${p.icon} ${p.color}`;
            
            input.placeholder = p.isSearch ? "Ketik judul lagu..." : `Tempel link ${p.name}...`;
            input.value = '';
            input.focus();
            showToast('Mode Ganti', `Beralih ke ${p.name}`, 'info');
        }

        function resetMode() {
            currentMode = 'auto';
            document.getElementById('detectBadge').classList.add('hidden');
            document.getElementById('inputIcon').className = "fa-solid fa-link text-slate-500";
        }

        async function executeDownload() {
            const input = document.getElementById('urlInput').value.trim();
            if(!input) return showToast('Error', 'Input tidak boleh kosong!', 'error');

            if(currentMode === 'auto') {
                 if(!input.startsWith('http')) return showToast('Info', 'Gunakan menu Cari Lagu untuk pencarian.', 'warning');
                 return showToast('Error', 'Platform tidak dikenali. Pilih manual.', 'error');
            }

            // UI State
            document.getElementById('resultCard').classList.add('hidden');
            document.getElementById('loader').classList.remove('hidden');
            document.getElementById('mainBtn').disabled = true;

            const conf = platforms[currentMode];
            let success = false;

            for(let i=0; i<conf.apis.length; i++) {
                const api = conf.apis[i];
                try {
                    let url = `${apiBase}${api.end}?${api.p}=${encodeURIComponent(input)}${api.x || ''}`;
                    const res = await fetch(url);
                    const json = await res.json();
                    
                    if(json && (json.url || json.result || json.data)) {
                        renderUI(json);
                        success = true;
                        break;
                    }
                } catch(e) {
                    console.log(`Server ${i} fail`);
                }
            }

            document.getElementById('loader').classList.add('hidden');
            document.getElementById('mainBtn').disabled = false;

            if(!success) showToast('Gagal', 'Server sibuk atau link private.', 'error');
        }

        function renderUI(data) {
            const card = document.getElementById('resultCard');
            const list = document.getElementById('downloadList');
            list.innerHTML = ''; // Clear old

            // Normalize
            let d = data.result || data.data || data;
            if(Array.isArray(d)) d = d[0];

            // Set Meta
            const img = d.thumbnail || d.cover || d.image || 'https://via.placeholder.com/150/0f172a/ffffff?text=No+Cover';
            document.getElementById('resThumb').src = img;
            document.getElementById('resTitle').innerText = d.title || d.caption || d.name || "Media Found";
            document.getElementById('resSource').innerText = platforms[currentMode].name;

            // Helper for buttons
            const addBtn = (url, label, type='download') => {
                const isVideo = type === 'video';
                const icon = isVideo ? 'fa-video' : (type === 'audio' ? 'fa-music' : 'fa-download');
                const div = document.createElement('div');
                div.className = "flex gap-2";
                div.innerHTML = `
                    <a href="${url}" target="_blank" download class="flex-grow bg-white/5 hover:bg-white/10 border border-white/10 text-white py-2.5 px-4 rounded-lg flex items-center justify-between transition text-sm font-medium group">
                        <span class="flex items-center gap-2"><i class="fa-solid ${icon} ${isVideo ? 'text-blue-400':'text-purple-400'}"></i> ${label}</span>
                        <i class="fa-solid fa-arrow-down text-slate-500 group-hover:text-white"></i>
                    </a>
                    <button onclick="window.open('${url}', '_blank')" class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-3 rounded-lg border border-slate-700" title="Paksa Buka (Jika Download Gagal)">
                        <i class="fa-solid fa-external-link-alt text-xs"></i>
                    </button>
                `;
                list.appendChild(div);
            };

            // Logic Extraction
            if(d.download && d.download.url) addBtn(d.download.url, 'Download MP3', 'audio');
            else if(d.url) addBtn(d.url, 'Download File Utama', 'download');
            
            if(d.video) addBtn(d.video, 'Download Video', 'video');
            if(d.audio) addBtn(d.audio, 'Download Audio', 'audio');
            
            // Handle Arrays (Slides)
            if(Array.isArray(data.result) && data.result.length > 1) {
                data.result.forEach((item, i) => {
                    if(typeof item === 'string') addBtn(item, `Slide ${i+1}`, 'video');
                    else if(item.url) addBtn(item.url, `Download ${i+1}`, 'download');
                });
            }

            card.classList.remove('hidden');
            card.scrollIntoView({behavior:'smooth', block:'center'});
        }

        // --- UTILS ---
        function showToast(title, msg, type) {
            const t = document.getElementById('toast');
            const icons = { error: 'fa-times-circle text-red-500', info: 'fa-info-circle text-blue-500', warning: 'fa-exclamation-triangle text-yellow-500' };
            
            document.getElementById('toastTitle').innerText = title;
            document.getElementById('toastMsg').innerText = msg;
            document.getElementById('toastIcon').className = `fa-solid ${icons[type] || icons.info}`;
            t.className = `fixed top-24 right-4 z-[100] transform transition-transform duration-300 flex items-center gap-3 px-4 py-3 bg-slate-800 border-l-4 rounded shadow-2xl max-w-xs ${type === 'error' ? 'border-red-500' : 'border-blue-500'}`;
            
            t.classList.remove('translate-x-[150%]');
            setTimeout(() => t.classList.add('translate-x-[150%]'), 3000);
        }

        function toggleModal(id) { document.getElementById(id).classList.toggle('hidden'); }
        function closeResult() { document.getElementById('resultCard').classList.add('hidden'); }
    </script>
</body>
</html>
